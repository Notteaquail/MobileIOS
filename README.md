# MobileIOS
MobileIOS swift

## 游戏介绍
黄金矿工是众所周知的一款网页通关小游戏，玩家通过键盘操纵钩子，在一定时间内（通常为一分钟）抓取物品，所抓物品价值超过一定数量便可进入下一关，玩家通过观察钩子的摆动角度，找准时间按键盘下钩，若角度准确，便可抓到想要的物品；

主要的物品有金块、石头、钻石、幸运袋、炸弹、老鼠等，物品的价值和重量都不同（石头即重又便宜、钻石即轻又贵、金块则又重又贵、幸运袋金额随机……），抓取物品的重量决定了拉回钩子的速度，若抓到石头则很亏，相反钻石很赚；

游戏的趣味性在于在性价比高但是难抓取的钻石（一般周围布满石头）、有一定风险的幸运袋和性价比略低但好抓取的金块（体积大）之间快速做抉择。

## 主要功能点

### 已实现
1.钩子的摆动和下钩动作
钩子实现为SKSpriteNode节点，通过旋转Action和移动Action控制摆动和下钩；


2.碰撞检测，拉回物体
碰撞检测可以通过创建SpriteKit中精灵节点内置的physicesBody参数，该参数可以实现为节点添加物理世界的一些性质（如重力，碰撞等），在这里我们将要抓取的物体设为静止物体，将钩子设为活动物体，并未其设置不同分类，当不同分类的物体相撞时，会执行contactBegin和contactEnd函数，在这些函数中实现抓取物体和回钩动作；
抓取物体时，在contactBegin函数中将物体节点从场景中删除，并添加为钩子节点的子节点，从而实现物体随钩子一同被拉回。

3.Modle模块
创建treasure类，用于存储物体的SKNode，重量，金币数以及index，通过重量属性设置回钩速度，抓取完成后将金币加入总金币数量中。

### 待实现
4.添加更多关卡，设计每一个关卡的物品布局，以增加游戏趣味性
每个关卡的通关金币数是累加的，越往后加的越多。

5.加入商店
玩家在进入关卡前首先会通过商店，可以在商店中消费金币购买辅助物品；辅助物品有炸弹（炸掉石头，快速回钩）、生力水（加速回钩）、幸运草（提高幸运袋价值）等；辅助物品的价格也是随机的，需要玩家自习衡量。

6.加入移动的老鼠、炸弹等物品
老鼠可能叼钻石也可能不叼，玩家需要预判抓取；玩家若抓到炸弹，会将周围一定范围内物品炸毁；叼钻老鼠若在炸弹附近出现，玩家抓取将会冒很大风险。


## 难点
1.下钩延长绳子问题（未解决）
主要难度在于和钩子相连的绳子的实现，绳子在下钩时需要延长；最初想法是通过SKShapeNode实时画线，发现难以实现，后查阅资料发现可以使用SKCropNode创建mask节点，用以覆盖未延长时绳子的延长线部分，需要计算钩子摆动时绳子的位置。

2.下钩动作
启动时钩子一直执行旋转动作，玩家触屏触发下钩动作，由于之前设置的旋转动作是repeatforever执行，将导致钩子进行旋转下落动作，后通过先将旋转动作删除，抓取完成后再添加一次解决

3.抓到物品后钩子乱走位现象
将抓到的物品节点添加为钩子节点的子节点后，本应直线拉回，测试时发现钩子乱飘，分析原因可能是所添加的物品具有物理世界的重力等属性，后通过直接将物品的physicesBody属性设为nil解决

4.炸弹爆炸范围的判断（未实现）
分析认为可能需要通过遍历所有的物体节点，依次判断是否在爆炸范围内，是则删除，暂未想到更好的办法
